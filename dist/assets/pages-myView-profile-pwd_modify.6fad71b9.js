import{Y as e,d as t,c as a,ap as o,C as s,U as n,o as i,e as r,w as l,i as d,f as u,j as h,u as p,A as m,v as c,x as f,Q as g,Z as _}from"./index-c87fa551.js";import{p as b}from"./phoneNum.90d59672.js";import{_ as w}from"./newback.52388a60.js";import{_ as C}from"./_plugin-vue_export-helper.1b428a4d.js";const I=C({data:()=>({formData:{AuthorizeCode:"",pwd:""},waiting:0,timer:null,phoneNumber:""}),onLoad(){this.phoneNumber=e.state.userInfo.User_Phone,console.log(this.phoneNumber),this.hiddenPhoneNumber()},computed:{userInfo:()=>e.state.userInfo},methods:{handleInput(){/[\u4E00-\u9FA5|\\！|\\，|\\。|\\（|\\）|\\《|\\》|\\“|\\”|\\？|\\：|\\；|\\【|\\】]/.test(this.formData.pwd)&&(console.log("对啦"),this.$nextTick((()=>{this.formData.pwd=""})))},hiddenPhoneNumber(){if(11!==this.phoneNumber.length)return this.phoneNumber;const e=this.phoneNumber.substring(0,3),t=this.phoneNumber.substring(8);this.phoneNumber=e+"*****"+t},submit(){this.formData.AuthorizeCode?this.formData.pwd?b(this.formData.pwd)?a("/User/UpdatePassword",{User_Id:this.userInfo.User_Id,User_NewPassword:this.formData.pwd,AuthorizeCode:this.formData.AuthorizeCode}).then((a=>{200!==a.Code?t({title:a.Message,icon:"none"}):(console.log(123132),e.commit("CHANGE_USER_ID",""),o({key:"user_Id"}),e.commit("CHANGE_USER_INFO",{}),console.log(12312313),s({url:"/pages/myView/index",animationType:"pop-in",animationDuration:200}))})):t({title:"密码需要6-12个字母和数字",icon:"none"}):t({title:"请输入新密码",icon:"none"}):t({title:"请输入验证码",icon:"none"})},back(){n(-1)},getCode(){this.waiting>0||a("/User/GainUpdatePasswordAuthorizeCode",{User_Id:this.userInfo.User_Id}).then((e=>{console.log(e.Code,"aaaaaaaa"),200!=e.Code&&t({title:e.Message,icon:"none"}),200==e.Code&&(t({title:"验证码发送成功，请查收短信",icon:"none"}),this.waiting=59,this.timer=setInterval((()=>{this.waiting<=0?clearInterval(this.timer):this.waiting=this.waiting-1}),1e3))}))}},onPageScroll(e){}},[["render",function(e,t,a,o,s,n){const b=c,C=d,I=f("var-app-bar"),N=g,U=_;return i(),r(C,{style:{"background-color":"#F8F8F8",height:"100vh"}},{default:l((()=>[u(I,{style:{"border-radius":"0",background:"#ffffff"},round:"",elevation:!1},{content:l((()=>[u(C,{class:"nav1"},{default:l((()=>[u(b,{onClick:n.back,style:{width:"40rpx",height:"40rpx","margin-left":"20rpx"},src:w,mode:"widthFix"},null,8,["onClick"]),u(C,{class:"navtitle1"},{default:l((()=>[h("密码修改")])),_:1})])),_:1})])),_:1}),u(C,{class:"profile-cells"},{default:l((()=>[u(C,{class:"tips"},{default:l((()=>[h("短信验证码将发送到手机号码"+p(s.phoneNumber)+"，请注意查收",1)])),_:1}),u(C,{class:"code"},{default:l((()=>[u(N,{class:"uni-input",maxlength:"6",type:"number",modelValue:s.formData.AuthorizeCode,"onUpdate:modelValue":t[0]||(t[0]=e=>s.formData.AuthorizeCode=e),placeholder:"请输入验证码"},null,8,["modelValue"]),u(C,{class:m(["btn",{disable:s.waiting>0}]),onClick:n.getCode},{default:l((()=>[h(p(s.waiting>0?s.waiting+"秒后重新获取":"获取验证码"),1)])),_:1},8,["onClick","class"])])),_:1}),u(C,{class:"code",style:{"padding-top":"52rpx"}},{default:l((()=>[u(N,{class:"uni-input",onInput:n.handleInput,modelValue:s.formData.pwd,"onUpdate:modelValue":t[1]||(t[1]=e=>s.formData.pwd=e),placeholder:"请输入新密码(6-12个字母和数字)"},null,8,["onInput","modelValue"])])),_:1}),u(C,{class:"btns"},{default:l((()=>[u(U,{type:"warn",onClick:n.submit},{default:l((()=>[h("确认修改")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-5781b527"]]);export{I as default};
