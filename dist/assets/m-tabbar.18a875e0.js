import{W as t,h as a,C as e,U as r,N as s,n as o,o as n,e as i,w as b,A as l,m as c,q as h,f as d,k as u,F as f,l as g,a6 as m,j as x,u as _,i as p,v as y}from"./index-c87fa551.js";import{t as I}from"./pages.af45dffb.js";import{_ as P}from"./_plugin-vue_export-helper.1b428a4d.js";const B=t=>{let a="";for(let e in t)a+=`${e}:${t[e]};`;return a},C=(t,a)=>t.startsWith(a)||t.startsWith("http")?t:`/${t}`;const k=P({emits:["change","click"],props:{current:{type:[Number,String],default:0},tabbar:{type:Object,default:()=>({})},fixed:{type:Boolean,default:!1},fill:{type:Boolean,default:!1},zIndex:{type:[Number,String],default:9999},native:{type:Boolean,default:!1},safeBottom:{type:Boolean,default:!0},beforeChange:{type:Function,default:null},tabbarHeight:{type:[Number,String],default:100}},data:()=>({isShowTabBar:!1,currentIndex:0,beforeData:{},reload:!1}),watch:{current(t){this.currentIndex=1*t}},computed:{tabbarConfig(){const{native:t,reload:a}=this;if(t){const{tabBar:t}=I;return t||(console.error("Native mode, Pages.json no tabbar config"),{borderStyle:"black",list:[]})}return this.tabbar},tabbarList(){const{list:t}=this.tabbarConfig;return t?(t=>!t.length>0?[]:t.map((t=>(t.iconPath&&(t.iconPath=C(t.iconPath,"/")),t.pagePath&&(t.pagePath=C(t.pagePath,"/")),t.selectedIconPath&&(t.selectedIconPath=C(t.selectedIconPath,"/")),t))))(t):(console.error("No tabbar config"),[])},borderStyle(){const{borderStyle:t}=this.tabbarConfig;return t},tabbarBoxStyle(){const{zIndex:t,reload:a}=this;return B({"z-index":t})},tabbarFillStyle(){const{tabbarHeight:t,safeBottom:a,reload:e}=this;return B({height:`${t}rpx`})},tabbarStyle(){const{tabbarHeight:t,reload:a}=this,{backgroundColor:e}=this.tabbarConfig;return B({height:`${t}rpx`,"background-color":e||"#fff"})},tabbarItemStyle(){const{currentIndex:t,reload:a}=this,{color:e,selectedColor:r}=this.tabbarConfig;return B({color:t?r:e})}},mounted(){this.initTabbar()},methods:{initTabbar(){const{current:e,fill:r,native:s,tabbarList:o}=this;if(this.currentIndex=1*e,s){const e=`/${t()[0].route}`,r=o.findIndex((t=>t.pagePath===e));this.currentIndex=r,o.length>0&&a()}setTimeout((()=>{this.isShowTabBar=!0}))},reLoad(){this.reload=!0,setTimeout((()=>{this.reload=!1}))},checkMaxIndex(t){return!!this.tabbarConfig.list[t]||(console.error("Max tabbar index"),!1)},setTabBarBadge(t){const{index:a,text:e}=t;this.checkMaxIndex(a)&&(this.tabbarConfig.list[a].dot=e,this.reLoad())},setTabBarItem(t){const{index:a,text:e,pagePath:r,iconPath:s,selectedIconPath:o}=t,{pagePath:n}=this.tabbarConfig.list[a];this.checkMaxIndex(a)&&(this.tabbarConfig.list[a]={pagePath:r||n,text:e,iconPath:s,selectedIconPath:o},this.reLoad())},showTabBar(){this.isShowTabBar=!0},hideTabBar(){this.isShowTabBar=!1},tabChange(t){const{currentIndex:a}=this;this.$emit("click",t),t!==a&&(this.beforeData={newIndex:t,oldIndex:a,next:this.jumpPage},this.beforeChange?this.beforeChange(this.jumpPage):this.jumpPage())},jumpPage(){const{native:t,beforeData:a,tabbarList:n}=this,{newIndex:i}=a,{pagePath:b,openType:l}=n[i];if(b)if(t)e({url:b});else switch(l){case"navigate":o({url:b});break;case"redirect":s({url:b});break;case"reLaunch":case"switchTab":default:e({url:b});break;case"navigateBack":r({delta:1})}this.$emit("change",i)}}},[["render",function(t,a,e,r,s,o){const I=p,P=y;return s.isShowTabBar?(n(),i(I,{key:0,class:"m-tabbar-box",style:c(o.tabbarBoxStyle)},{default:b((()=>[e.fill||e.native?(n(),i(I,{key:0,class:l(["m-tabbar__fill",{"m-tabbar__safe":e.safeBottom||e.native}]),style:c(o.tabbarFillStyle)},null,8,["class","style"])):h("",!0),d(I,{id:"m-tabbar",class:l(["m-tabbar",{fixed:e.fixed||e.native,"m-tabbar__safe":e.safeBottom||e.native}]),style:c(o.tabbarStyle)},{default:b((()=>["black"==o.borderStyle?(n(),i(I,{key:0,class:"m-tabbar__border"})):h("",!0),d(I,{class:"m-tabbar__flex"},{default:b((()=>[(n(!0),u(f,null,g(o.tabbarList,((a,e)=>(n(),i(I,{onClick:t=>o.tabChange(e),key:e,class:l(["m-tabbar__item",{"m-tabbar__item__active":e==s.currentIndex}])},{default:b((()=>[m(t.$slots,`tabbar_index_${e}`,{},(()=>[d(I,{class:"m-tabbar__icon"},{default:b((()=>[a.dot?(n(),i(I,{key:0,class:"m-tabbar__badge"},{default:b((()=>[x(_(a.dot),1)])),_:2},1024)):h("",!0),d(P,{src:s.currentIndex==e?a.selectedIconPath:a.iconPath,class:"m-tabbar__icon_img"},null,8,["src"])])),_:2},1024),d(I,{class:"m-tabbar__label",style:c({color:e==s.currentIndex?o.tabbarConfig.selectedColor:o.tabbarConfig.color})},{default:b((()=>[x(_(a.text),1)])),_:2},1032,["style"])]),!0)])),_:2},1032,["onClick","class"])))),128))])),_:3})])),_:3},8,["class","style"])])),_:3},8,["style"])):h("",!0)}],["__scopeId","data-v-446ad4b6"]]);export{k as _};
